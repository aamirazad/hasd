---
import Head from "../components/Head.astro";
const { title, className } = Astro.props;
import "../styles/global.css";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

import { Image } from "astro:assets";
import smallBackgroundImage from "../assets/bwca-day-small.webp";

interface Props {
  title: string;
  className?: string;
}
---

<html lang="en">
  <head>
    <Head title={title} />
  </head>
  <body class="flex flex-col min-h-screen">
    <Header />
    <main class="flex-grow">
      <Image
        id="bg-low"
        src={smallBackgroundImage}
        loading="eager"
        width={1920}
        height={1080}
        alt="a low quality calm landscape painting background"
        class="text-[#e8f5ea] fixed inset-0 z-[-10] pointer-events-none object-cover transition-filter duration-500 ease-in-out bg-[#e8f5ea]"
      />

      <Image
        id="bg-high"
        src="https://cdn.aamira.me/bwca-day.webp"
        alt="a high quality calm landscape painting background"
        loading="lazy"
        width={1920}
        height={1080}
        class="fixed inset-0 z-[-10] pointer-events-none object-cover transition-filter duration-500 ease-in-out bg-[#e8f5ea] opacity-0"
      />

      <script>
        // FADE IN HIGH QUALITY IMAGE
        // Load a low quality image quickly and then blur in the high quality image before removing the low quality one
        const lowResDiv = document.getElementById("bg-low");
        const highResDiv = document.getElementById("bg-high");
        const highResImageUrl = "https://cdn.aamira.me/bwca-day.webp";

        const highResImg = new Image();
        highResImg.src = highResImageUrl;

        highResImg.onload = () => {
          highResDiv?.classList.remove("opacity-0");
          lowResDiv?.classList.add("blur-none");
          setTimeout(() => {
            lowResDiv?.classList.add("hidden");
          }, 500);
        };

        highResImg.onerror = () => {
          console.error("Failed to load high-resolution image.");
        };
      </script>
      <!-- MAIN CONTENT -->
      <div class={`${className}`}><slot /></div>
    </main>
    <Footer />
  </body>
</html>
